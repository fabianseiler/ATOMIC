Version 4
SHEET 1 2472 1840
WIRE -1360 144 -1360 128
WIRE -1280 304 -1312 304
WIRE -1264 304 -1280 304
WIRE -1360 320 -1360 224
WIRE -1264 320 -1264 304
WIRE -1312 336 -1312 304
WIRE -1312 400 -1312 384
WIRE -1264 400 -1312 400
WIRE -1264 416 -1264 400
WIRE -1360 496 -1360 400
WIRE -1392 544 -1424 544
WIRE -1424 736 -1424 608
WIRE -1008 736 -1424 736
WIRE -672 736 -1008 736
WIRE -16 736 -672 736
WIRE 464 736 -16 736
WIRE 944 736 464 736
WIRE 1408 736 944 736
WIRE 1888 736 1408 736
WIRE -1008 768 -1008 736
WIRE -672 832 -672 736
WIRE -592 832 -624 832
WIRE -576 832 -592 832
WIRE -16 832 -16 736
WIRE 64 832 32 832
WIRE 80 832 64 832
WIRE -624 848 -624 832
WIRE 32 848 32 832
WIRE 464 848 464 736
WIRE 528 848 512 848
WIRE 560 848 528 848
WIRE 944 848 944 736
WIRE 1008 848 992 848
WIRE 1040 848 1008 848
WIRE 1408 848 1408 736
WIRE 1472 848 1456 848
WIRE 1504 848 1472 848
WIRE 1888 848 1888 736
WIRE 1952 848 1936 848
WIRE 1984 848 1952 848
WIRE 512 864 512 848
WIRE 992 864 992 848
WIRE 1456 864 1456 848
WIRE 1936 864 1936 848
WIRE -1008 896 -1008 848
WIRE -624 912 -624 896
WIRE -576 912 -624 912
WIRE -464 912 -464 896
WIRE 32 912 32 896
WIRE 80 912 32 912
WIRE 192 912 192 896
WIRE 672 912 672 896
WIRE 1136 912 1136 896
WIRE 1616 912 1616 896
WIRE 2096 912 2096 896
WIRE -576 928 -576 912
WIRE 80 928 80 912
WIRE 512 928 512 912
WIRE 560 928 512 928
WIRE 992 928 992 912
WIRE 1040 928 992 928
WIRE 1456 928 1456 912
WIRE 1504 928 1456 928
WIRE 1936 928 1936 912
WIRE 1984 928 1936 928
WIRE 560 944 560 928
WIRE 1040 944 1040 928
WIRE 1504 944 1504 928
WIRE 1984 944 1984 928
WIRE -1360 992 -1360 976
WIRE -464 1024 -464 992
WIRE 192 1024 192 992
WIRE 672 1024 672 992
WIRE 1136 1024 1136 992
WIRE 1616 1024 1616 992
WIRE 2096 1024 2096 992
WIRE -496 1072 -528 1072
WIRE 160 1072 128 1072
WIRE 640 1072 608 1072
WIRE 1104 1072 1072 1072
WIRE 1584 1072 1552 1072
WIRE 2064 1072 2032 1072
WIRE -1296 1136 -1312 1136
WIRE -1264 1136 -1296 1136
WIRE -1360 1152 -1360 1072
WIRE -1264 1152 -1264 1136
WIRE -1312 1168 -1312 1136
WIRE -672 1184 -672 912
WIRE -528 1184 -528 1136
WIRE -528 1184 -672 1184
WIRE -16 1184 -16 912
WIRE 128 1184 128 1136
WIRE 128 1184 -16 1184
WIRE 464 1184 464 928
WIRE 608 1184 608 1136
WIRE 608 1184 464 1184
WIRE 944 1184 944 928
WIRE 1072 1184 1072 1136
WIRE 1072 1184 944 1184
WIRE 1408 1184 1408 928
WIRE 1552 1184 1552 1136
WIRE 1552 1184 1408 1184
WIRE 1888 1184 1888 928
WIRE 2032 1184 2032 1136
WIRE 2032 1184 1888 1184
WIRE -1312 1232 -1312 1216
WIRE -1264 1232 -1312 1232
WIRE -1264 1248 -1264 1232
WIRE 464 1296 464 1184
WIRE 544 1296 512 1296
WIRE 560 1296 544 1296
WIRE 944 1296 944 1184
WIRE 1024 1296 992 1296
WIRE 1040 1296 1024 1296
WIRE 1408 1296 1408 1184
WIRE 1472 1296 1456 1296
WIRE 1504 1296 1472 1296
WIRE 1888 1296 1888 1184
WIRE 1952 1296 1936 1296
WIRE 1984 1296 1952 1296
WIRE -1360 1312 -1360 1232
WIRE 512 1312 512 1296
WIRE 992 1312 992 1296
WIRE 1456 1312 1456 1296
WIRE 1936 1312 1936 1296
WIRE -672 1328 -672 1184
WIRE -592 1328 -624 1328
WIRE -576 1328 -592 1328
WIRE -16 1328 -16 1184
WIRE 64 1328 32 1328
WIRE 80 1328 64 1328
WIRE -624 1344 -624 1328
WIRE 32 1344 32 1328
WIRE -1392 1360 -1424 1360
WIRE 512 1376 512 1360
WIRE 560 1376 512 1376
WIRE 992 1376 992 1360
WIRE 1040 1376 992 1376
WIRE 1456 1376 1456 1360
WIRE 1504 1376 1456 1376
WIRE 1936 1376 1936 1360
WIRE 1984 1376 1936 1376
WIRE 560 1392 560 1376
WIRE 1040 1392 1040 1376
WIRE 1504 1392 1504 1376
WIRE 1984 1392 1984 1376
WIRE -624 1408 -624 1392
WIRE -576 1408 -624 1408
WIRE 32 1408 32 1392
WIRE 80 1408 32 1408
WIRE -576 1424 -576 1408
WIRE 80 1424 80 1408
WIRE -1424 1472 -1424 1424
WIRE -1008 1472 -1424 1472
WIRE -672 1472 -672 1408
WIRE -672 1472 -1008 1472
WIRE -16 1472 -16 1408
WIRE -16 1472 -672 1472
WIRE 464 1472 464 1376
WIRE 464 1472 -16 1472
WIRE 944 1472 944 1376
WIRE 944 1472 464 1472
WIRE 1408 1472 1408 1376
WIRE 1408 1472 944 1472
WIRE 1888 1472 1888 1376
WIRE 1888 1472 1408 1472
WIRE -1008 1520 -1008 1472
WIRE -1008 1632 -1008 1600
FLAG -1008 896 0
FLAG -1008 1632 0
FLAG -1360 128 0
FLAG 672 896 0
FLAG -1360 976 0
FLAG 1136 896 0
FLAG 192 896 0
FLAG -1264 416 0
FLAG -1264 1248 0
FLAG -1392 544 a
FLAG 640 1072 w1
FLAG -1392 1360 b
FLAG 1104 1072 w2
FLAG 160 1072 c
FLAG 1616 896 0
FLAG 1584 1072 w3
FLAG 2096 896 0
FLAG 2064 1072 w4
FLAG 80 1424 0
FLAG 560 1392 0
FLAG 560 944 0
FLAG 1040 944 0
FLAG 1040 1392 0
FLAG 1504 1392 0
FLAG 1504 944 0
FLAG 1984 944 0
FLAG 1984 1392 0
FLAG 80 928 0
FLAG 64 832 c_sw1
FLAG 64 1328 c_sw2
FLAG 528 848 w1_sw1
FLAG 544 1296 w1_sw2
FLAG 1008 848 w2_sw1
FLAG 1024 1296 w2_sw2
FLAG 1472 848 w3_sw1
FLAG 1472 1296 w3_sw2
FLAG 1952 848 w4_sw1
FLAG 1952 1296 w4_sw2
FLAG -1280 304 a_sw
FLAG -1296 1136 b_sw
FLAG -464 896 0
FLAG -496 1072 cin
FLAG -576 1424 0
FLAG -576 928 0
FLAG -592 832 cin_sw1
FLAG -592 1328 cin_sw2
SYMBOL res -1024 752 R0
SYMATTR InstName R1
SYMATTR Value {R_g}
SYMBOL voltage -1360 240 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=a.csv
SYMATTR InstName V1
SYMBOL voltage 672 1008 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w1.csv
SYMATTR InstName V11
SYMBOL res -1024 1504 R0
SYMATTR InstName R2
SYMATTR Value {R_g}
SYMBOL voltage -1360 1088 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=b.csv
SYMATTR InstName V3
SYMBOL voltage 1136 1008 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w2.csv
SYMATTR InstName V14
SYMBOL voltage 192 1008 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=c.csv
SYMATTR InstName V8
SYMBOL sw -1360 416 R180
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL voltage -1264 304 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=a_sw.csv
SYMATTR InstName V2
SYMBOL sw -1360 1248 R180
SYMATTR InstName S2
SYMATTR Value MYSW
SYMBOL voltage -1264 1136 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=b_sw.csv
SYMATTR InstName V4
SYMBOL voltage 1616 1008 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w3.csv
SYMATTR InstName V17
SYMBOL voltage 80 1312 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=c_sw2.csv
SYMATTR InstName V10
SYMBOL voltage 560 1280 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w1_sw2.csv
SYMATTR InstName V13
SYMBOL voltage 560 832 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w1_sw1.csv
SYMATTR InstName V12
SYMBOL voltage 1040 832 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w2_sw1.csv
SYMATTR InstName V15
SYMBOL voltage 1040 1280 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w2_sw2.csv
SYMATTR InstName V16
SYMBOL voltage 1504 1280 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w3_sw2.csv
SYMATTR InstName V19
SYMBOL voltage 1504 832 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w3_sw1.csv
SYMATTR InstName V18
SYMBOL voltage 1984 832 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w4_sw1.csv
SYMATTR InstName V21
SYMBOL voltage 1984 1280 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w4_sw2.csv
SYMATTR InstName V22
SYMBOL sw -16 1424 R180
SYMATTR InstName S6
SYMATTR Value MYSW
SYMBOL sw 464 944 R180
SYMATTR InstName S7
SYMATTR Value MYSW
SYMBOL sw 464 1392 R180
SYMATTR InstName S8
SYMATTR Value MYSW
SYMBOL sw 944 944 R180
SYMATTR InstName S9
SYMATTR Value MYSW
SYMBOL sw 944 1392 R180
SYMATTR InstName S10
SYMATTR Value MYSW
SYMBOL sw 1408 944 R180
SYMATTR InstName S11
SYMATTR Value MYSW
SYMBOL sw 1408 1392 R180
SYMATTR InstName S12
SYMATTR Value MYSW
SYMBOL sw 1888 944 R180
SYMATTR InstName S13
SYMATTR Value MYSW
SYMBOL sw 1888 1392 R180
SYMATTR InstName S14
SYMATTR Value MYSW
SYMBOL voltage 2096 1008 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V20
SYMATTR Value PWL file=w4.csv
SYMBOL voltage 80 816 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL file=c_sw1.csv
SYMATTR InstName V9
SYMBOL sw -16 928 R180
SYMATTR InstName S5
SYMATTR Value MYSW
SYMBOL VTEAM_knowm -1472 496 R0
WINDOW 39 1541 -86 Bottom 2
SYMATTR SpiceLine w_init={w_a} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xa
SYMBOL VTEAM_knowm -1472 1312 R0
WINDOW 39 1542 -880 Bottom 2
SYMATTR SpiceLine w_init={w_b} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xb
SYMBOL VTEAM_knowm 80 1024 R0
WINDOW 39 -11 -543 Bottom 2
SYMATTR SpiceLine w_init={w_c} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xc
SYMBOL VTEAM_knowm 560 1024 R0
WINDOW 39 -479 -520 Bottom 2
SYMATTR SpiceLine w_init={w_w1} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xw1
SYMBOL VTEAM_knowm 1024 1024 R0
WINDOW 39 -943 -496 Bottom 2
SYMATTR SpiceLine w_init={w_w2} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xw2
SYMBOL VTEAM_knowm 1504 1024 R0
WINDOW 39 -1422 -472 Bottom 2
SYMATTR SpiceLine w_init={w_w3} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xw3
SYMBOL VTEAM_knowm 1984 1024 R0
WINDOW 39 -1903 -445 Bottom 2
SYMATTR SpiceLine w_init={w_w4} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xw4
SYMBOL voltage -464 1008 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=cin.csv
SYMATTR InstName V5
SYMBOL voltage -576 1312 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=cin_sw2.csv
SYMATTR InstName V7
SYMBOL sw -672 1424 R180
SYMATTR InstName S4
SYMATTR Value MYSW
SYMBOL voltage -576 816 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL file=cin_sw1.csv
SYMATTR InstName V6
SYMBOL sw -672 928 R180
SYMATTR InstName S3
SYMATTR Value MYSW
SYMBOL VTEAM_knowm -576 1024 R0
WINDOW 39 656 -568 Bottom 2
SYMATTR SpiceLine w_init={w_cin} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xcin
TEXT 96 88 Left 2 !.model MYSW SW(Ron=1n Roff=1000meg Vt=.5)
TEXT 96 112 Left 2 !.param R_g=40k
TEXT -192 352 Left 2 !.tran {tstop}
TEXT -200 88 Left 2 !.param w_a=0n
TEXT -200 112 Left 2 !.param w_b=0n
TEXT -200 160 Left 2 !.param w_c=0n
TEXT -200 136 Left 2 !.param w_cin=0n
TEXT -200 184 Left 2 !.param w_w1=0n
TEXT -200 208 Left 2 !.param w_w2=0n
TEXT -200 232 Left 2 !.param w_w3=0n
TEXT -200 256 Left 2 !.param w_w4=0n
TEXT -192 328 Left 2 !.meas sum AVG -V(n001)*I(V1)  -V(n010)*I(V3)  -V(n004)*I(V5)  -V(n005)*I(V8)  -V(n006)*I(V11)  -V(n007)*I(V14)  -V(n008)*I(V17)  -V(n009)*I(V20)
TEXT 96 152 Left 2 !.param R_on=10k
TEXT 96 176 Left 2 !.param R_off=1000k
TEXT 96 256 Left 2 !.param tstop=600us
TEXT 96 200 Left 2 !.param v_on=-10m
TEXT 96 224 Left 2 !.param v_off=700m

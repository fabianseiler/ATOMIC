Version 4
SHEET 1 2940 1840
WIRE -1872 112 -1872 96
WIRE -1504 128 -1504 112
WIRE -1152 128 -1152 112
WIRE -832 128 -832 112
WIRE -496 128 -496 112
WIRE -208 128 -208 112
WIRE 112 128 112 112
WIRE 432 128 432 112
WIRE 736 128 736 112
WIRE -1792 272 -1824 272
WIRE -1776 272 -1792 272
WIRE -1440 272 -1456 272
WIRE -1408 272 -1440 272
WIRE -1088 272 -1104 272
WIRE -1056 272 -1088 272
WIRE -768 272 -784 272
WIRE -736 272 -768 272
WIRE -432 272 -448 272
WIRE -400 272 -432 272
WIRE -144 272 -160 272
WIRE -112 272 -144 272
WIRE 176 272 160 272
WIRE 208 272 176 272
WIRE 496 272 480 272
WIRE 528 272 496 272
WIRE 800 272 784 272
WIRE 832 272 800 272
WIRE -1872 288 -1872 192
WIRE -1776 288 -1776 272
WIRE -1504 288 -1504 208
WIRE -1408 288 -1408 272
WIRE -1152 288 -1152 208
WIRE -1056 288 -1056 272
WIRE -832 288 -832 208
WIRE -736 288 -736 272
WIRE -496 288 -496 208
WIRE -400 288 -400 272
WIRE -208 288 -208 208
WIRE -112 288 -112 272
WIRE 112 288 112 208
WIRE 208 288 208 272
WIRE 432 288 432 208
WIRE 528 288 528 272
WIRE 736 288 736 208
WIRE 832 288 832 272
WIRE -1824 304 -1824 272
WIRE -1456 304 -1456 272
WIRE -1104 304 -1104 272
WIRE -784 304 -784 272
WIRE -448 304 -448 272
WIRE -160 304 -160 272
WIRE 160 304 160 272
WIRE 480 304 480 272
WIRE 784 304 784 272
WIRE -1824 368 -1824 352
WIRE -1776 368 -1824 368
WIRE -1456 368 -1456 352
WIRE -1408 368 -1456 368
WIRE -1104 368 -1104 352
WIRE -1056 368 -1104 368
WIRE -784 368 -784 352
WIRE -736 368 -784 368
WIRE -448 368 -448 352
WIRE -400 368 -448 368
WIRE -160 368 -160 352
WIRE -112 368 -160 368
WIRE 160 368 160 352
WIRE 208 368 160 368
WIRE 480 368 480 352
WIRE 528 368 480 368
WIRE 784 368 784 352
WIRE 832 368 784 368
WIRE -1776 384 -1776 368
WIRE -1408 384 -1408 368
WIRE -1056 384 -1056 368
WIRE -736 384 -736 368
WIRE -400 384 -400 368
WIRE -112 384 -112 368
WIRE 208 384 208 368
WIRE 528 384 528 368
WIRE 832 384 832 368
WIRE -1504 448 -1504 368
WIRE -1152 448 -1152 368
WIRE -832 448 -832 368
WIRE -496 448 -496 368
WIRE -208 448 -208 368
WIRE 112 448 112 368
WIRE 432 448 432 368
WIRE 736 448 736 368
WIRE -1872 464 -1872 368
WIRE -1536 496 -1568 496
WIRE -1184 496 -1216 496
WIRE -864 496 -896 496
WIRE -528 496 -560 496
WIRE -240 496 -272 496
WIRE 80 496 48 496
WIRE 400 496 368 496
WIRE 704 496 672 496
WIRE -1904 512 -1936 512
WIRE -1936 704 -1936 576
WIRE -1568 704 -1568 560
WIRE -1568 704 -1936 704
WIRE -1216 704 -1216 560
WIRE -1216 704 -1568 704
WIRE -896 704 -896 560
WIRE -896 704 -1216 704
WIRE -560 704 -560 560
WIRE -560 704 -896 704
WIRE -272 704 -272 560
WIRE -272 704 -560 704
WIRE 48 704 48 560
WIRE 48 704 -272 704
WIRE 368 704 368 560
WIRE 368 704 48 704
WIRE 672 704 672 560
WIRE 672 704 368 704
WIRE -1936 752 -1936 704
WIRE -1936 864 -1936 832
FLAG -1936 864 0
FLAG -1872 96 0
FLAG -1504 112 0
FLAG -1776 384 0
FLAG -1408 384 0
FLAG -1536 496 b
FLAG -1792 272 a_sw
FLAG -1440 272 b_sw
FLAG -208 112 0
FLAG -112 384 0
FLAG -240 496 w1
FLAG -144 272 w1_sw
FLAG -1904 512 a
FLAG 112 112 0
FLAG 208 384 0
FLAG 80 496 w2
FLAG 176 272 w2_sw
FLAG -1152 112 0
FLAG -1056 384 0
FLAG -1184 496 c
FLAG -1088 272 c_sw
FLAG 432 112 0
FLAG 528 384 0
FLAG 400 496 w3
FLAG 496 272 w3_sw
FLAG -832 112 0
FLAG -736 384 0
FLAG -864 496 d
FLAG -768 272 d_sw
FLAG 736 112 0
FLAG 832 384 0
FLAG 704 496 w4
FLAG 800 272 w4_sw
FLAG -496 112 0
FLAG -400 384 0
FLAG -528 496 cin
FLAG -432 272 cin_sw
SYMBOL res -1952 736 R0
SYMATTR InstName R1
SYMATTR Value {R_g}
SYMBOL voltage -1872 208 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=a.csv
SYMATTR InstName V1
SYMBOL voltage -1504 224 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=b.csv
SYMATTR InstName V3
SYMBOL sw -1872 384 R180
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL voltage -1776 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=a_sw.csv
SYMATTR InstName V2
SYMBOL sw -1504 384 R180
SYMATTR InstName S2
SYMATTR Value MYSW
SYMBOL voltage -1408 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=b_sw.csv
SYMATTR InstName V4
SYMBOL VTEAM_knowm -1616 448 R0
WINDOW 39 -27 -594 Bottom 2
SYMATTR SpiceLine w_init={w_b} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xb
SYMBOL voltage -208 224 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w1.csv
SYMATTR InstName V11
SYMBOL sw -208 384 R180
SYMATTR InstName S6
SYMATTR Value MYSW
SYMBOL voltage -112 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w1_sw.csv
SYMATTR InstName V12
SYMBOL VTEAM_knowm -320 448 R0
WINDOW 39 -276 -639 Bottom 2
SYMATTR SpiceLine w_init={w_w1} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xw1
SYMBOL VTEAM_knowm -1984 464 R0
WINDOW 39 343 -646 Bottom 2
SYMATTR SpiceLine w_init={w_a} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xa
SYMBOL voltage 112 224 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w2.csv
SYMATTR InstName V13
SYMBOL sw 112 384 R180
SYMATTR InstName S7
SYMATTR Value MYSW
SYMBOL voltage 208 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w2_sw.csv
SYMATTR InstName V14
SYMBOL VTEAM_knowm 0 448 R0
WINDOW 39 -594 -611 Bottom 2
SYMATTR SpiceLine w_init={w_w2} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xw2
SYMBOL voltage -1152 224 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=c.csv
SYMATTR InstName V5
SYMBOL sw -1152 384 R180
SYMATTR InstName S3
SYMATTR Value MYSW
SYMBOL voltage -1056 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=c_sw.csv
SYMATTR InstName V6
SYMBOL VTEAM_knowm -1264 448 R0
WINDOW 39 -383 -561 Bottom 2
SYMATTR SpiceLine w_init={w_c} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xc
SYMBOL voltage 432 224 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w3.csv
SYMATTR InstName V15
SYMBOL sw 432 384 R180
SYMATTR InstName S8
SYMATTR Value MYSW
SYMBOL voltage 528 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w3_sw.csv
SYMATTR InstName V16
SYMBOL VTEAM_knowm 320 448 R0
WINDOW 39 -911 -586 Bottom 2
SYMATTR SpiceLine w_init={w_w3} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xw3
SYMBOL voltage -832 224 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=d.csv
SYMATTR InstName V7
SYMBOL sw -832 384 R180
SYMATTR InstName S4
SYMATTR Value MYSW
SYMBOL voltage -736 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=d_sw.csv
SYMATTR InstName V8
SYMBOL VTEAM_knowm -944 448 R0
WINDOW 39 -703 -534 Bottom 2
SYMATTR SpiceLine w_init={w_d} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xd
SYMBOL voltage 736 224 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w4.csv
SYMATTR InstName V17
SYMBOL sw 736 384 R180
SYMATTR InstName S9
SYMATTR Value MYSW
SYMBOL voltage 832 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w4_sw.csv
SYMATTR InstName V18
SYMBOL VTEAM_knowm 624 448 R0
WINDOW 39 -1219 -554 Bottom 2
SYMATTR SpiceLine w_init={w_w4} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xw4
SYMBOL voltage -496 224 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=cin.csv
SYMATTR InstName V9
SYMBOL sw -496 384 R180
SYMATTR InstName S5
SYMATTR Value MYSW
SYMBOL voltage -400 272 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=cin_sw.csv
SYMATTR InstName V10
SYMBOL VTEAM_knowm -608 448 R0
WINDOW 39 -1038 -458 Bottom 2
SYMATTR SpiceLine w_init={w_cin} R_on={R_on} R_off={R_off} v_on={v_on} v_off={v_off}
SYMATTR InstName Xcin
TEXT 1016 408 Left 2 !.model MYSW SW(Ron=1n Roff=1000meg Vt=.5)
TEXT 1016 440 Left 2 !.param R_g=40k
TEXT 1016 80 Left 2 !.tran {tstop}
TEXT 1016 496 Left 2 !.param w_a=0n
TEXT 1016 528 Left 2 !.param w_b=0n
TEXT 1016 560 Left 2 !.param w_c=0n
TEXT 1248 496 Left 2 !.param w_w1=0n
TEXT 1248 528 Left 2 !.param w_w2=0n
TEXT 1248 560 Left 2 !.param w_w3=0n
TEXT 1576 496 Left 2 !.param R_on=10k
TEXT 1576 528 Left 2 !.param R_off=1000k
TEXT 1016 56 Left 2 !.meas sum AVG -V(n001)*I(V1) -V(n002)*I(V3) -V(n003)*I(V5) -V(n004)*I(V7) -V(n005)*I(V9) -V(n006)*I(V11) -V(n007)*I(V13) -V(n008)*I(V15) -V(n009)*I(V17)
TEXT 1016 112 Left 2 !.param tstop=240u
TEXT 1032 232 Left 2 !.meas w2 AVG -V(n005)*I(V9)
TEXT 1032 264 Left 2 !.meas w3 AVG -V(n006)*I(V11)
TEXT 1016 592 Left 2 !.param w_d=0n
TEXT 1248 592 Left 2 !.param w_w4=0n
TEXT 1016 632 Left 2 !.param w_cin=0n
TEXT 1576 560 Left 2 !.param v_on=-10m
TEXT 1576 592 Left 2 !.param v_off=700m

Version 4
SHEET 1 2472 1840
WIRE -1360 144 -1360 128
WIRE -992 160 -992 144
WIRE -640 160 -640 144
WIRE -224 160 -224 144
WIRE 96 160 96 144
WIRE 416 160 416 144
WIRE -1280 304 -1312 304
WIRE -1264 304 -1280 304
WIRE -928 304 -944 304
WIRE -896 304 -928 304
WIRE -576 304 -592 304
WIRE -544 304 -576 304
WIRE -160 304 -176 304
WIRE -128 304 -160 304
WIRE 160 304 144 304
WIRE 192 304 160 304
WIRE 480 304 464 304
WIRE 512 304 480 304
WIRE -1360 320 -1360 224
WIRE -1264 320 -1264 304
WIRE -992 320 -992 240
WIRE -896 320 -896 304
WIRE -640 320 -640 240
WIRE -544 320 -544 304
WIRE -224 320 -224 240
WIRE -128 320 -128 304
WIRE 96 320 96 240
WIRE 192 320 192 304
WIRE 416 320 416 240
WIRE 512 320 512 304
WIRE -1312 336 -1312 304
WIRE -944 336 -944 304
WIRE -592 336 -592 304
WIRE -176 336 -176 304
WIRE 144 336 144 304
WIRE 464 336 464 304
WIRE -1312 400 -1312 384
WIRE -1264 400 -1312 400
WIRE -944 400 -944 384
WIRE -896 400 -944 400
WIRE -592 400 -592 384
WIRE -544 400 -592 400
WIRE -176 400 -176 384
WIRE -128 400 -176 400
WIRE 144 400 144 384
WIRE 192 400 144 400
WIRE 464 400 464 384
WIRE 512 400 464 400
WIRE -1264 416 -1264 400
WIRE -896 416 -896 400
WIRE -544 416 -544 400
WIRE -128 416 -128 400
WIRE 192 416 192 400
WIRE 512 416 512 400
WIRE -992 480 -992 400
WIRE -640 480 -640 400
WIRE -224 480 -224 400
WIRE 96 480 96 400
WIRE 416 480 416 400
WIRE -1360 496 -1360 400
WIRE -1024 528 -1056 528
WIRE -672 528 -704 528
WIRE -256 528 -288 528
WIRE 64 528 32 528
WIRE 384 528 352 528
WIRE -1392 544 -1424 544
WIRE -1424 736 -1424 608
WIRE -1056 736 -1056 592
WIRE -1056 736 -1424 736
WIRE -704 736 -704 592
WIRE -704 736 -1056 736
WIRE -288 736 -288 592
WIRE -288 736 -704 736
WIRE 32 736 32 592
WIRE 32 736 -288 736
WIRE 352 736 352 592
WIRE 352 736 32 736
WIRE -1424 784 -1424 736
WIRE -1424 896 -1424 864
FLAG -1424 896 0
FLAG -1360 128 0
FLAG -992 144 0
FLAG -1264 416 0
FLAG -896 416 0
FLAG -1024 528 b
FLAG -1280 304 a_sw
FLAG -928 304 b_sw
FLAG -224 144 0
FLAG -128 416 0
FLAG -256 528 w1
FLAG -160 304 w1_sw
FLAG -1392 544 a
FLAG 96 144 0
FLAG 192 416 0
FLAG 64 528 w2
FLAG 160 304 w2_sw
FLAG -640 144 0
FLAG -544 416 0
FLAG -672 528 c
FLAG -576 304 c_sw
FLAG 416 144 0
FLAG 512 416 0
FLAG 384 528 w3
FLAG 480 304 w3_sw
SYMBOL res -1440 768 R0
SYMATTR InstName R1
SYMATTR Value {R_g}
SYMBOL voltage -1360 240 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=a.csv
SYMATTR InstName V1
SYMBOL voltage -992 256 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=b.csv
SYMATTR InstName V3
SYMBOL sw -1360 416 R180
SYMATTR InstName S3
SYMATTR Value MYSW
SYMBOL voltage -1264 304 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=a_sw.csv
SYMATTR InstName V2
SYMBOL sw -992 416 R180
SYMATTR InstName S5
SYMATTR Value MYSW
SYMBOL voltage -896 304 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=b_sw.csv
SYMATTR InstName V4
SYMBOL VTEAM_knowm -1104 480 R0
WINDOW 39 -23 -513 Bottom 2
SYMATTR SpiceLine w_init={w_b} R_on={R_on} R_off={R_off}
SYMATTR InstName X1
SYMBOL voltage -224 256 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w1.csv
SYMATTR InstName V7
SYMBOL sw -224 416 R180
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL voltage -128 304 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w1_sw.csv
SYMATTR InstName V8
SYMBOL VTEAM_knowm -336 480 R0
WINDOW 39 -781 -463 Bottom 2
SYMATTR SpiceLine w_init={w_w1} R_on={R_on} R_off={R_off}
SYMATTR InstName X2
SYMBOL VTEAM_knowm -1472 496 R0
WINDOW 39 345 -555 Bottom 2
SYMATTR SpiceLine w_init={w_a} R_on={R_on} R_off={R_off}
SYMATTR InstName X4
SYMBOL voltage 96 256 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w2.csv
SYMATTR InstName V9
SYMBOL sw 96 416 R180
SYMATTR InstName S2
SYMATTR Value MYSW
SYMBOL voltage 192 304 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w2_sw.csv
SYMATTR InstName V10
SYMBOL VTEAM_knowm -16 480 R0
WINDOW 39 -1101 -438 Bottom 2
SYMATTR SpiceLine w_init={w_w2} R_on={R_on} R_off={R_off}
SYMATTR InstName X3
SYMBOL voltage -640 256 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=c.csv
SYMATTR InstName V5
SYMBOL sw -640 416 R180
SYMATTR InstName S4
SYMATTR Value MYSW
SYMBOL voltage -544 304 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=c_sw.csv
SYMATTR InstName V6
SYMBOL VTEAM_knowm -752 480 R0
WINDOW 39 -376 -487 Bottom 2
SYMATTR SpiceLine w_init={w_c} R_on={R_on} R_off={R_off}
SYMATTR InstName X5
SYMBOL voltage 416 256 R180
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w3.csv
SYMATTR InstName V11
SYMBOL sw 416 416 R180
SYMATTR InstName S6
SYMATTR Value MYSW
SYMBOL voltage 512 304 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL file=w3_sw.csv
SYMATTR InstName V12
SYMBOL VTEAM_knowm 304 480 R0
WINDOW 39 -1421 -413 Bottom 2
SYMATTR SpiceLine w_init={w_w3} R_on={R_on} R_off={R_off}
SYMATTR InstName X6
TEXT 648 344 Left 2 !.model MYSW SW(Ron=1n Roff=1000meg Vt=.5)
TEXT 648 376 Left 2 !.param R_g=40k
TEXT 648 16 Left 2 !.tran {tstop}
TEXT 648 456 Left 2 !.param w_a=0n
TEXT 648 488 Left 2 !.param w_b=0n
TEXT 648 520 Left 2 !.param w_c=0n
TEXT 648 552 Left 2 !.param w_w1=0n
TEXT 648 584 Left 2 !.param w_w2=0n
TEXT 648 616 Left 2 !.param w_w3=0n
TEXT 648 672 Left 2 !.param R_on=10k
TEXT 648 704 Left 2 !.param R_off=1000k
TEXT 648 -8 Left 2 !.meas sum AVG -V(n001)*I(V1) -V(n002)*I(V3) -V(n003)*I(V5) -V(n004)*I(V7) -V(n005)*I(V9) -V(n006)*I(V11)
TEXT 648 48 Left 2 !.param tstop=240u
TEXT 664 168 Left 2 !.meas w2 AVG -V(n005)*I(V9)
TEXT 664 200 Left 2 !.meas w3 AVG -V(n006)*I(V11)
